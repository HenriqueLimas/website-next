server import { createHighlighter } from "shiki";
server import { markoDark, markoLight } from "app/util/syntax-highlight-theme"
export interface Input {
  lang: string;
  text: string;
  theme?: "light" | "dark" | "reverse";
  concise?: string;
  filename?: string;
}
server const highlighter = await createHighlighter({
  langs: ["marko", "html", "css", "js", "ts", "json", "fs", "sh"],
  themes: [markoDark, markoLight],
});

const/highlightedText=highlighter.codeToHtml(input.text, {
  lang: input.lang,
  defaultColor: false,
  themes: {
    light: "marko-light",
    dark: "marko-dark"
  }
})

const/highlightedConcise=input.concise &&
  highlighter.codeToHtml(input.concise, {
    lang: input.lang,
    defaultColor: false,
    themes: {
      light: "marko-light",
      dark: "marko-dark"
    }
  })

.code-block.${input.theme && `code-block--${input.theme}`}
  if=input.filename
    .filename -- ${input.filename}
  if=input.concise
    .html -- $!{highlightedText}
    .concise -- $!{highlightedConcise}
  else
    -- $!{highlightedText}
